knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(Matrix)
library(umap)
RNA_expression_matrix <- readRDS("../data/RNA-Seq-filtered.rds")
RNA_expression_matrix <- readRDS("../data/pre_pocessed/RNA-Seq-filtered.rds")
setwd("F:/DS_Project/UMAP")
RNA_expression_matrix <- readRDS("../data/pre_pocessed/RNA-Seq-filtered.rds")
RNA_expression_matrix <- readRDS("../data/pre_processed/RNA-Seq-filtered.rds")
RNA_annnotations <- read_csv("../data/pre_processed/RNA_annotations.csv")
DEG <- read_csv("../DESeq/genes_by_sig.csv")
DEG <- distinct(DEG, gene)[1:100]
DEG <- distinct(DEG, gene)[1:100,]
RNA_expression_matrix <- RNA_expression_matrix[DEG$gene,]
umap <- umap(t(RNA_expression_matrix))
RNA_umap <- as_tibble(umap_1 = umap$layout[,1],
umap_2 = umap$layout[,2],
Celltype = RNA_annotations$Sub_trajectory_name)
RNA_umap <- tibble(umap_1 = umap$layout[,1],
umap_2 = umap$layout[,2],
Celltype = RNA_annotations$Sub_trajectory_name)
RNA_annotations <- read_csv("../data/pre_processed/RNA_annotations.csv")
RNA_umap <- tibble(umap_1 = umap$layout[,1],
umap_2 = umap$layout[,2],
Celltype = RNA_annotations$Sub_trajectory_name)
ggplot(ATAC_umap, aes(x = umap_1, y = umap_2, color = Celltype)) +
geom_point()
ggplot(RNA_umap, aes(x = umap_1, y = umap_2, color = Celltype)) +
geom_point()
ggsave("plots/UMAP_RNA.png")
custom.config <- umap.defaults
custom.config$n_neighbors <- 100
umap <- umap(t(RNA_expression_matrix))
custom.config <- umap.defaults
custom.config$n_neighbors <- 100
umap <- umap(t(RNA_expression_matrix), config = custom.config)
custom.config <- umap.defaults
custom.config$n_neighbors <- 15
umap <- umap(t(RNA_expression_matrix), config = custom.config)
knitr::opts_chunk$set(echo = TRUE)
library(Matrix)
RNA_data <- readRDS("../data/pre_processed/RNA-Seq-filtered.rds")
DEG <- read_csv("../DESeq/genes_by_sig.csv")
DEG <- DEG %>%
filter(padj <= 0.05) %>%
distinct(gene, keep_all = TRUE) %>%
head(100)
RNA_expression_matrix <- RNA_expression_matrix[DEG$gene,]
DEG <- DEG %>%
filter(padj <= 0.05) %>%
distinct(gene, keep_all = TRUE) %>%
head(100)
RNA_data <- readRDS("../data/pre_processed/RNA-Seq-filtered.rds")
DEG <- read_csv("../DESeq/genes_by_sig.csv")
DEG <- DEG %>%
filter(padj <= 0.05) %>%
distinct(gene, .keep_all = TRUE) %>%
head(100)
RNA_data <- RNA_data[DEG$gene,]
write.table(Matrix(t(RNA_expression_matrix)),
file="../data/training/train_data_RNA.txt")
write.table(Matrix(t(RNA_data)),
file="../data/training/train_data_RNA.txt")
write.table(matrix(t(RNA_data)),
file="../data/training/train_data_RNA.txt")
write.table(as.matrix(t(RNA_data)),
file="../data/training/train_data_RNA.txt")
custom.config <- umap.defaults
custom.config$n_neighbors <- 15
umap <- umap(t(RNA_expression_matrix), config = custom.config)
RNA_expression_matrix <- readRDS("../data/pre_processed/RNA-Seq-filtered.rds")
RNA_annotations <- read_csv("../data/pre_processed/RNA_annotations.csv")
DEG <- read_csv("../DESeq/genes_by_sig.csv")
DEG <- DEG %>%
filter(padj <= 0.05) %>%
distinct(gene, keep_all = TRUE) %>%
head(100)
RNA_expression_matrix <- RNA_expression_matrix[DEG$gene,]
custom.config <- umap.defaults
custom.config$n_neighbors <- 15
umap <- umap(t(RNA_expression_matrix), config = custom.config)
RNA_umap <- tibble(umap_1 = umap$layout[,1],
umap_2 = umap$layout[,2],
Celltype = RNA_annotations$Sub_trajectory_name)
ggplot(RNA_umap, aes(x = umap_1, y = umap_2, color = Celltype)) +
geom_point()
ggsave("plots/UMAP_RNA.png")
umap.defaults
custom.config <- umap.defaults
custom.config$n_neighbors <- 30
umap <- umap(t(RNA_expression_matrix), config = custom.config)
RNA_umap <- tibble(umap_1 = umap$layout[,1],
umap_2 = umap$layout[,2],
Celltype = RNA_annotations$Sub_trajectory_name)
ggplot(RNA_umap, aes(x = umap_1, y = umap_2, color = Celltype)) +
geom_point()
ggsave("plots/UMAP_RNA.png")
custom.config <- umap.defaults
custom.config$n_neighbors <- 10
umap <- umap(t(RNA_expression_matrix), config = custom.config)
custom.config <- umap.defaults
custom.config$n_neighbors <- 5
umap <- umap(t(RNA_expression_matrix), config = custom.config)
RNA_umap <- tibble(umap_1 = umap$layout[,1],
umap_2 = umap$layout[,2],
Celltype = RNA_annotations$Sub_trajectory_name)
ggplot(RNA_umap, aes(x = umap_1, y = umap_2, color = Celltype)) +
geom_point()
ggsave("plots/UMAP_RNA.png")
umap.defaults
custom.config <- umap.defaults
custom.config$n_neighbors <- 5
custom.config$min_dist <- 0.5
umap <- umap(t(RNA_expression_matrix), config = custom.config)
RNA_umap <- tibble(umap_1 = umap$layout[,1],
umap_2 = umap$layout[,2],
Celltype = RNA_annotations$Sub_trajectory_name)
ggplot(RNA_umap, aes(x = umap_1, y = umap_2, color = Celltype)) +
geom_point()
ggsave("plots/UMAP_RNA.png")
custom.config <- umap.defaults
#custom.config$n_neighbors <- 5
#custom.config$min_dist <- 0.5
umap <- umap(t(RNA_expression_matrix), config = custom.config)
RNA_umap <- tibble(umap_1 = umap$layout[,1],
umap_2 = umap$layout[,2],
Celltype = RNA_annotations$Sub_trajectory_name)
ggplot(RNA_umap, aes(x = umap_1, y = umap_2, color = Celltype)) +
geom_point()
ggsave("plots/UMAP_RNA.png")
DEG <- DEG %>%
filter(padj <= 0.05) %>%
distinct(gene, keep_all = TRUE) %>%
head(150)
DEG <- read_csv("../DESeq/genes_by_sig.csv")
RNA_expression_matrix <- readRDS("../data/pre_processed/RNA-Seq-filtered.rds")
DEG <- DEG %>%
filter(padj <= 0.05) %>%
distinct(gene, keep_all = TRUE) %>%
head(150)
RNA_expression_matrix <- RNA_expression_matrix[DEG$gene,]
custom.config <- umap.defaults
#custom.config$n_neighbors <- 5
#custom.config$min_dist <- 0.5
umap <- umap(t(RNA_expression_matrix), config = custom.config)
RNA_umap <- tibble(umap_1 = umap$layout[,1],
umap_2 = umap$layout[,2],
Celltype = RNA_annotations$Sub_trajectory_name)
ggplot(RNA_umap, aes(x = umap_1, y = umap_2, color = Celltype)) +
geom_point()
ggsave("plots/UMAP_RNA.png")
RNA_expression_matrix <- readRDS("../data/pre_processed/RNA-Seq-filtered.rds")
RNA_annotations <- read_csv("../data/pre_processed/RNA_annotations.csv")
DEG <- DEG %>%
filter(padj <= 0.05) %>%
distinct(gene, keep_all = TRUE) %>%
head(200)
DEG <- read_csv("../DESeq/genes_by_sig.csv")
DEG <- DEG %>%
filter(padj <= 0.05) %>%
distinct(gene, keep_all = TRUE) %>%
head(200)
RNA_expression_matrix <- RNA_expression_matrix[DEG$gene,]
custom.config <- umap.defaults
#custom.config$n_neighbors <- 5
#custom.config$min_dist <- 0.5
umap <- umap(t(RNA_expression_matrix), config = custom.config)
RNA_umap <- tibble(umap_1 = umap$layout[,1],
umap_2 = umap$layout[,2],
Celltype = RNA_annotations$Sub_trajectory_name)
ggplot(RNA_umap, aes(x = umap_1, y = umap_2, color = Celltype)) +
geom_point()
ggsave("plots/UMAP_RNA.png")
View(RNA_annotations)
length(RNA_annotations$Sub_trajectory_name[RNA_annotations$Sub_trajectory_name == "Megakaryocyte trajectory"])
