library(tidyverse)
data <- read_csv("top_50_genes.csv")
nrow(distinct(data, gene))
knitr::opts_chunk$set(echo = TRUE)
library(DESeq2)
library(Matrix)
library(tidyverse)
library(BiocParallel)
register(SnowParam(4))
RNA_expression_matrix <- readRDS("../data/pre_processed/RNA-Seq-filtered.rds")
RNA_expression_matrix <- RNA_expression_matrix + 1
RNA_annotations <- read_csv("../data/pre_processed/RNA_annotations.csv",show_col_types = FALSE)
dds <- DESeqDataSetFromMatrix(countData = RNA_expression_matrix,
colData = select(RNA_annotations, sample, Sub_trajectory_name),
design = ~ Sub_trajectory_name)
dea <- DESeq(dds, parallel = TRUE)
results <- results(dea, contrast = c("Sub_trajectory_name",
"Definitive erythroid trajectory",
"White blood cell trajectory"))
plotMA(results)
Sub_traj <- distinct(RNA_annotations, Sub_trajectory_name)$Sub_trajectory_name
res_list <- list()
for(i in 1:(length(Sub_traj)-1)){
for(j in (i+1):length(Sub_traj)){
temp <- list(results(dea, contrast = c("Sub_trajectory_name",
Sub_traj[i],
Sub_traj[j])))
res_list <- append(res_list, temp)
}
}
combined_res <- do.call(rbind, lapply(res_list, function(x) {
tibble(gene = rownames(x), padj = x$padj)
}))
combined_res <- combined_res %>% filter(padj != 0)
combined_res <- combined_res[order(combined_res$padj),]
write_csv(head(distinct(combined_res, gene), 50), "top_50_genes.csv")
knitr::opts_chunk$set(echo = TRUE)
library(DESeq2)
library(Matrix)
library(tidyverse)
library(BiocParallel)
register(SnowParam(4))
RNA_expression_matrix <- readRDS("../data/pre_processed/RNA-Seq-filtered.rds")
RNA_expression_matrix <- RNA_expression_matrix + 1
RNA_annotations <- read_csv("../data/pre_processed/RNA_annotations.csv",show_col_types = FALSE)
dds <- DESeqDataSetFromMatrix(countData = RNA_expression_matrix,
colData = select(RNA_annotations, sample, Sub_trajectory_name),
design = ~ Sub_trajectory_name)
dea <- DESeq(dds, parallel = TRUE)
results <- results(dea, contrast = c("Sub_trajectory_name",
"Definitive erythroid trajectory",
"White blood cell trajectory"))
plotMA(results)
Sub_traj <- distinct(RNA_annotations, Sub_trajectory_name)$Sub_trajectory_name
res_list <- list()
for(i in 1:(length(Sub_traj)-1)){
for(j in (i+1):length(Sub_traj)){
temp <- list(results(dea, contrast = c("Sub_trajectory_name",
Sub_traj[i],
Sub_traj[j])))
res_list <- append(res_list, temp)
}
}
combined_res <- do.call(rbind, lapply(res_list, function(x) {
tibble(gene = rownames(x), padj = x$padj)
}))
combined_res <- combined_res %>% filter(padj != 0)
combined_res <- combined_res[order(combined_res$padj),]
write_csv(combined_res, "genes_by_sig.csv")
knitr::opts_chunk$set(echo = TRUE)
library(DESeq2)
library(Matrix)
library(tidyverse)
library(BiocParallel)
register(SnowParam(4))
RNA_expression_matrix <- readRDS("../data/pre_processed/RNA-Seq-filtered.rds")
RNA_expression_matrix <- RNA_expression_matrix + 1
RNA_annotations <- read_csv("../data/pre_processed/RNA_annotations.csv",show_col_types = FALSE)
dds <- DESeqDataSetFromMatrix(countData = RNA_expression_matrix,
colData = select(RNA_annotations, sample, Sub_trajectory_name),
design = ~ Sub_trajectory_name)
dea <- DESeq(dds, parallel = TRUE)
results <- results(dea, contrast = c("Sub_trajectory_name",
"Definitive erythroid trajectory",
"White blood cell trajectory"))
plotMA(results)
Sub_traj <- distinct(RNA_annotations, Sub_trajectory_name)$Sub_trajectory_name
res_list <- list()
for(i in 1:(length(Sub_traj)-1)){
for(j in (i+1):length(Sub_traj)){
temp <- list(results(dea, contrast = c("Sub_trajectory_name",
Sub_traj[i],
Sub_traj[j])))
res_list <- append(res_list, temp)
}
}
combined_res <- do.call(rbind, lapply(res_list, function(x) {
tibble(gene = rownames(x), padj = x$padj)
}))
combined_res <- combined_res %>% filter(padj != 0)
combined_res <- combined_res[order(combined_res$padj),]
write_csv(combined_res, "genes_by_sig.csv")
combined_res <- combined_res %>%
filter(padj <= 0.05) %>%
distinct(gene, .keep_all = TRUE)
write_csv(combined_res, "genes_by_sig_unique.csv")
